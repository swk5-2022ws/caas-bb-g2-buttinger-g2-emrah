FROM mcr.microsoft.com/dotnet/sdk:6.0 AS build-stage

WORKDIR /opt/CaaS
COPY ./CaaS .
RUN dotnet tool restore \
  && dotnet build \
  && dotnet publish -o dist

FROM mcr.microsoft.com/dotnet/aspnet:6.0

WORKDIR /opt/CaaS

COPY --from=build-stage /opt/CaaS .
#COPY --from=build-stage /opt/CaaS/dist .

ENV ASPNETCORE_URLS "http://0.0.0.0:5000"

CMD dotnet test
